{"version":3,"sources":["BottomTabView.tsx"],"names":["React","View","StyleSheet","useTheme","ScreenContainer","SafeAreaProviderCompat","ResourceSavingScene","BottomTabBar","SceneContent","isFocused","children","colors","styles","content","backgroundColor","background","BottomTabView","state","loaded","props","index","renderTabBar","tabBar","tabBarOptions","navigation","descriptors","route","routes","descriptor","key","options","tabBarVisible","lazy","unmountInactiveScreens","container","pages","map","includes","absoluteFill","render","nextProps","prevState","Component","defaultProps","create","flex","overflow"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { View, StyleSheet } from 'react-native';\n\nimport { TabNavigationState } from '@react-navigation/routers';\nimport { useTheme } from '@react-navigation/native';\n// eslint-disable-next-line import/no-unresolved\nimport { ScreenContainer } from 'react-native-screens';\n\nimport SafeAreaProviderCompat from './SafeAreaProviderCompat';\nimport ResourceSavingScene from './ResourceSavingScene';\nimport BottomTabBar from './BottomTabBar';\nimport {\n  BottomTabNavigationConfig,\n  BottomTabDescriptorMap,\n  BottomTabNavigationHelpers,\n  BottomTabBarProps,\n} from '../types';\n\ntype Props = BottomTabNavigationConfig & {\n  state: TabNavigationState;\n  navigation: BottomTabNavigationHelpers;\n  descriptors: BottomTabDescriptorMap;\n};\n\ntype State = {\n  loaded: number[];\n};\n\nfunction SceneContent({\n  isFocused,\n  children,\n}: {\n  isFocused: boolean;\n  children: React.ReactNode;\n}) {\n  const { colors } = useTheme();\n\n  return (\n    <View\n      accessibilityElementsHidden={!isFocused}\n      importantForAccessibility={isFocused ? 'auto' : 'no-hide-descendants'}\n      style={[styles.content, { backgroundColor: colors.background }]}\n    >\n      {children}\n    </View>\n  );\n}\n\nexport default class BottomTabView extends React.Component<Props, State> {\n  static defaultProps = {\n    lazy: true,\n  };\n\n  static getDerivedStateFromProps(nextProps: Props, prevState: State) {\n    const { index } = nextProps.state;\n\n    return {\n      // Set the current tab to be loaded if it was not loaded before\n      loaded: prevState.loaded.includes(index)\n        ? prevState.loaded\n        : [...prevState.loaded, index],\n    };\n  }\n\n  state = {\n    loaded: [this.props.state.index],\n  };\n\n  private renderTabBar = () => {\n    const {\n      tabBar = (props: BottomTabBarProps) => <BottomTabBar {...props} />,\n      tabBarOptions,\n      state,\n      navigation,\n    } = this.props;\n\n    const { descriptors } = this.props;\n    const route = state.routes[state.index];\n    const descriptor = descriptors[route.key];\n    const options = descriptor.options;\n\n    if (options.tabBarVisible === false) {\n      return null;\n    }\n\n    return tabBar({\n      ...tabBarOptions,\n      state: state,\n      descriptors: descriptors,\n      navigation: navigation,\n    });\n  };\n\n  render() {\n    const { state, descriptors, lazy, unmountInactiveScreens } = this.props;\n    const { routes } = state;\n    const { loaded } = this.state;\n\n    return (\n      <SafeAreaProviderCompat>\n        <View style={styles.container}>\n          <ScreenContainer style={styles.pages}>\n            {routes.map((route, index) => {\n              if (unmountInactiveScreens && index !== state.index) {\n                return null;\n              }\n\n              if (lazy && !loaded.includes(index)) {\n                // Don't render a screen if we've never navigated to it\n                return null;\n              }\n\n              const isFocused = state.index === index;\n\n              return (\n                <ResourceSavingScene\n                  key={route.key}\n                  style={StyleSheet.absoluteFill}\n                  isVisible={isFocused}\n                >\n                  <SceneContent isFocused={isFocused}>\n                    {descriptors[route.key].render()}\n                  </SceneContent>\n                </ResourceSavingScene>\n              );\n            })}\n          </ScreenContainer>\n          {this.renderTabBar()}\n        </View>\n      </SafeAreaProviderCompat>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    overflow: 'hidden',\n  },\n  pages: {\n    flex: 1,\n  },\n  content: {\n    flex: 1,\n  },\n});\n"]}